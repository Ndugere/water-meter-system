{% extends "core/base.html" %}
{% load static %}
{% load humanize %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container-fluid py-5" style="background-color:#f5f7fa; min-height:80vh;">

  <!-- KPIs -->
  <div class="row g-3 mb-5 text-center">
    <!-- Read-only KPI Cards -->
    <div class="col-6 col-md-3">
      <div class="kpi-card border rounded-4 p-3">
        <div class="text-muted small">Customers</div>
        <div class="fs-4 fw-bold text-dark">{{ total_customers|intcomma }}</div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="kpi-card border rounded-4 p-3">
        <div class="text-muted small">Meters</div>
        <div class="fs-4 fw-bold text-dark">{{ total_meters|intcomma }}</div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="kpi-card border rounded-4 p-3">
        <div class="text-muted small">Readings Today</div>
        <div class="fs-4 fw-bold text-dark">{{ readings_today|intcomma }}</div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="kpi-card border rounded-4 p-3">
        <div class="text-muted small">Unpaid Bills</div>
        <div class="fs-4 fw-bold text-dark">{{ unpaid_bills|intcomma }}</div>
      </div>
    </div>
  </div>

  <!-- Financial KPIs -->
  <div class="row g-3 mb-5 text-center">
    <div class="col-6 col-md-4">
      <div class="kpi-card bg-primary text-white rounded-4 p-3 shadow-sm">
        <div class="small">Total Billed</div>
        <div class="fs-5 fw-bold">KSh {{ total_billed|floatformat:2|intcomma }}</div>
      </div>
    </div>
    <div class="col-6 col-md-4">
      <div class="kpi-card bg-warning text-dark rounded-4 p-3 shadow-sm">
        <div class="small">Total Due</div>
        <div class="fs-5 fw-bold">KSh {{ total_due|floatformat:2|intcomma }}</div>
      </div>
    </div>
    <div class="col-6 col-md-4">
      <div class="kpi-card bg-success text-white rounded-4 p-3 shadow-sm">
        <div class="small">Total Collected</div>
        <div class="fs-5 fw-bold">KSh {{ total_collected|floatformat:2|intcomma }}</div>
      </div>
    </div>
  </div>

  <!-- Main Categories -->
  <div class="row g-4">
    <div class="col-lg-3 col-md-6">
      <a href="{% url 'customers_meters' %}" class="dashboard-btn btn-customers">
        <i class="bi bi-people-fill fs-1 mb-3"></i>
        <span class="fw-bold fs-5">Customers & Meters</span>
      </a>
    </div>

    <div class="col-lg-3 col-md-6">
      <a href="{% url 'billing_payments' %}" class="dashboard-btn btn-billing">
        <i class="bi bi-cash-coin fs-1 mb-3"></i>
        <span class="fw-bold fs-5">Billing & Payments</span>
      </a>
    </div>

    <div class="col-lg-3 col-md-6">
      <a href="{% url 'reports_analysis' %}" class="dashboard-btn btn-reports">
        <i class="bi bi-bar-chart-line fs-1 mb-3"></i>
        <span class="fw-bold fs-5">Reports & Notifications</span>
      </a>
    </div>
    

    <div class="col-lg-3 col-md-6">
      <a href="{% url 'system_settings' %}" class="dashboard-btn btn-settings">
        <i class="bi bi-gear-fill fs-1 mb-3"></i>
        <span class="fw-bold fs-5">Settings & Support</span>
      </a>
    </div>
  </div>
</div>

<style>
  /* KPI cards */
  .kpi-card {
    background-color: transparent;
    transition: transform .2s ease;
  }
  .kpi-card:hover { transform: translateY(-4px); }

  /* Dashboard Buttons (default = white, hover = color) */
  .dashboard-btn {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 200px;
    width: 100%;
    border-radius: 1rem;
    background: white;
    box-shadow: 0 6px 14px rgba(0,0,0,0.1);
    text-decoration: none;
    font-weight: bold;
    transition: all 0.3s ease;
  }
  .dashboard-btn i, .dashboard-btn span {
    transition: all 0.3s ease;
  }
  .dashboard-btn:hover {
    transform: translateY(-8px) scale(1.03);
    box-shadow: 0 16px 32px rgba(0,0,0,0.2);
  }

  /* Specific color themes */
  .btn-customers { color: #0d6efd; }
  .btn-customers:hover { background-color: #0d6efd; color: white; }

  .btn-billing { color: #198754; }
  .btn-billing:hover { background-color: #198754; color: white; }

  .btn-reports { color: #ffc107; }
  .btn-reports:hover { background-color: #ffc107; color: white; }

  .btn-settings { color: #6c757d; }
  .btn-settings:hover { background-color: #6c757d; color: white; }
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
{% endblock %}
